xt7 <- data_test$tree2.pred[h,]
var <- data_test$const.pred[h, ] # for var
tl <- start:(end - h)
ind <- gw.test(xt[tl],xt4[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bols"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt3[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt2[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt5[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt6[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboos2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt7[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tree"] <- ifelse(ind <= 0.05, 1, 0)
}
}
i
h
for (h in 11:12) {
for (i in c(1:32, 34:44, 47:65, 67:90, 92:115, 117:125, 127:140)) {
data_test <- readMat(paste("IPEAtests2", M, "/", filenames[i], sep = ""))
start <- data_test$test.data.start[1]
end <- tail(data_test$test.data.end, 1)
yt <- data_test$true.Ytph[h, ] # true value
xt <- data_test$ar.pred[h, ] # linear
xt2 <- data_test$tsboost.pred[h, ] # tsboost
xt3 <- data_test$bspline.pred[h, ] # bspline
xt4 <- data_test$bols.pred[h, ] # bols
xt5 <- data_test$bspline.noextra.pred[h,]
xt6 <- data_test$tsboost.noextra.pred[h,]
xt7 <- data_test$tree2.pred[h,]
var <- data_test$const.pred[h, ] # for var
tl <- start:(end - h)
ind <- gw.test(xt[tl],xt4[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bols"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt3[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt2[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt5[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt6[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboos2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt7[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tree"] <- ifelse(ind <= 0.05, 1, 0)
}
}
i
h
for (h in 11:12) {
for (i in c(1:32, 34:44, 47:65, 67:90, 92:107, 109:115, 117:125, 127:140)) {
data_test <- readMat(paste("IPEAtests2", M, "/", filenames[i], sep = ""))
start <- data_test$test.data.start[1]
end <- tail(data_test$test.data.end, 1)
yt <- data_test$true.Ytph[h, ] # true value
xt <- data_test$ar.pred[h, ] # linear
xt2 <- data_test$tsboost.pred[h, ] # tsboost
xt3 <- data_test$bspline.pred[h, ] # bspline
xt4 <- data_test$bols.pred[h, ] # bols
xt5 <- data_test$bspline.noextra.pred[h,]
xt6 <- data_test$tsboost.noextra.pred[h,]
xt7 <- data_test$tree2.pred[h,]
var <- data_test$const.pred[h, ] # for var
tl <- start:(end - h)
ind <- gw.test(xt[tl],xt4[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bols"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt3[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt2[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt5[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt6[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboos2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt7[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tree"] <- ifelse(ind <= 0.05, 1, 0)
}
}
for (h in 1:12) {
for (i in c(1:32, 34:44, 47:65, 67:90, 92:107, 109:115, 117:125, 127:140)) {
data_test <- readMat(paste("IPEAtests2", M, "/", filenames[i], sep = ""))
start <- data_test$test.data.start[1]
end <- tail(data_test$test.data.end, 1)
yt <- data_test$true.Ytph[h, ] # true value
xt <- data_test$ar.pred[h, ] # linear
xt2 <- data_test$tsboost.pred[h, ] # tsboost
xt3 <- data_test$bspline.pred[h, ] # bspline
xt4 <- data_test$bols.pred[h, ] # bols
xt5 <- data_test$bspline.noextra.pred[h,]
xt6 <- data_test$tsboost.noextra.pred[h,]
xt7 <- data_test$tree2.pred[h,]
var <- data_test$const.pred[h, ] # for var
tl <- start:(end - h)
ind <- gw.test(xt[tl],xt4[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bols"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt3[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt2[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt5[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt6[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboos2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt7[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tree"] <- ifelse(ind <= 0.05, 1, 0)
}
}
all_cases
all <- data.frame(
"linear" = rep(0, 12),
"bols" = rep(0, 12),
"bspline" = rep(0, 12),
"tsboost" = rep(0, 12),
"bspline2" = rep(0, 12),
"tsboost2" = rep(0, 12),
"tree" = rep(0, 12)
)
for (i in 1:12) {
base = all_cases[[i]]
all[i, ] <- sapply(base, sum)
}
all
all_cases
all_cases[[1]]
M <- 300
filenames <- list.files(paste("IPEAtests2", M, "/", sep = ""))
linear <- rep(0, 140)
bols <- rep(0, 140)
bspline <- rep(0, 140)
tsboost <- rep(0, 140)
bspline2 <- rep(0, 140)
tsboost2 <- rep(0, 140)
tree  <- rep(0, 140)
all_cases <- list()
for (i in 1:12) {
all_cases[[i]] <- data.frame(linear, bols, bspline, tsboost, bspline2, tsboost2, tree)
}
for (h in 1:12) {
for (i in c(1:32, 34:44, 47:65, 67:90, 92:107, 109:115, 117:125, 127:140)) {
data_test <- readMat(paste("IPEAtests2", M, "/", filenames[i], sep = ""))
start <- data_test$test.data.start[1]
end <- tail(data_test$test.data.end, 1)
yt <- data_test$true.Ytph[h, ] # true value
xt <- data_test$ar.pred[h, ] # linear
xt2 <- data_test$tsboost.pred[h, ] # tsboost
xt3 <- data_test$bspline.pred[h, ] # bspline
xt4 <- data_test$bols.pred[h, ] # bols
xt5 <- data_test$bspline.noextra.pred[h,]
xt6 <- data_test$tsboost.noextra.pred[h,]
xt7 <- data_test$tree2.pred[h,]
var <- data_test$const.pred[h, ] # for var
tl <- start:(end - h)
ind <- gw.test(xt[tl],xt4[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bols"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt3[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt2[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt5[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt6[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt[tl],xt7[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tree"] <- ifelse(ind <= 0.05, 1, 0)
}
}
all <- data.frame(
"linear" = rep(0, 12),
"bols" = rep(0, 12),
"bspline" = rep(0, 12),
"tsboost" = rep(0, 12),
"bspline2" = rep(0, 12),
"tsboost2" = rep(0, 12),
"tree" = rep(0, 12)
)
all <- data.frame(
"linear" = rep(0, 12),
"bols" = rep(0, 12),
"bspline" = rep(0, 12),
"tsboost" = rep(0, 12),
"bspline2" = rep(0, 12),
"tsboost2" = rep(0, 12),
"tree" = rep(0, 12)
)
for (i in 1:12) {
base = all_cases[[i]]
all[i, ] <- sapply(base, sum)
}
all
M <- 300
filenames <- list.files(paste("IPEAtests2", M, "/", sep = ""))
linear <- rep(0, 140)
bols <- rep(0, 140)
bspline <- rep(0, 140)
tsboost <- rep(0, 140)
bspline2 <- rep(0, 140)
tsboost2 <- rep(0, 140)
tree  <- rep(0, 140)
all_cases <- list()
for (i in 1:12) {
all_cases[[i]] <- data.frame(linear, bols, bspline, tsboost, bspline2, tsboost2, tree)
}
for (h in 1:12) {
for (i in c(1:32, 34:44, 47:65, 67:90, 92:107, 109:115, 117:125, 127:140)) {
data_test <- readMat(paste("IPEAtests2", M, "/", filenames[i], sep = ""))
start <- data_test$test.data.start[1]
end <- tail(data_test$test.data.end, 1)
yt <- data_test$true.Ytph[h, ] # true value
xt <- data_test$ar.pred[h, ] # linear
xt2 <- data_test$tsboost.pred[h, ] # tsboost
xt3 <- data_test$bspline.pred[h, ] # bspline
xt4 <- data_test$bols.pred[h, ] # bols
xt5 <- data_test$bspline.noextra.pred[h,]
xt6 <- data_test$tsboost.noextra.pred[h,]
xt7 <- data_test$tree2.pred[h,]
var <- data_test$const.pred[h, ] # for var
tl <- start:(end - h)
ind <- gw.test(xt4[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bols"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt3[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt2[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt5[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt6[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt7[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'greater', method = 'HAC')$p.value
all_cases[[h]][i, "tree"] <- ifelse(ind <= 0.05, 1, 0)
}
}
all <- data.frame(
"bols" = rep(0, 12),
"bspline" = rep(0, 12),
"tsboost" = rep(0, 12),
"bspline2" = rep(0, 12),
"tsboost2" = rep(0, 12),
"tree" = rep(0, 12)
)
for (i in 1:12) {
base = all_cases[[i]]
all[i, ] <- sapply(base, sum)
}
all
all_cases[[h]][i, "bols"]
all_cases[[h]]
all <- data.frame(
"bols" = rep(0, 12),
"bspline" = rep(0, 12),
"tsboost" = rep(0, 12),
"bspline2" = rep(0, 12),
"tsboost2" = rep(0, 12),
"tree" = rep(0, 12)
)
for (i in 1:12) {
base = all_cases[[i]]
all[i, ] <- sapply(base, sum)
}
all
all <- data.frame(
"bols" = rep(0, 12),
"bspline" = rep(0, 12),
"tsboost" = rep(0, 12),
"bspline2" = rep(0, 12),
"tsboost2" = rep(0, 12),
"tree" = rep(0, 12)
)
all[i, ]
all[i, ]
all[i, ]
all[i, ]
all <- data.frame(
"linear" = rep(0, 12),
"bols" = rep(0, 12),
"bspline" = rep(0, 12),
"tsboost" = rep(0, 12),
"bspline2" = rep(0, 12),
"tsboost2" = rep(0, 12),
"tree" = rep(0, 12)
)
for (i in 1:12) {
base = all_cases[[i]]
all[i, ] <- sapply(base, sum)
}
all
for (h in 1:12) {
for (i in c(1:32, 34:44, 47:65, 67:90, 92:107, 109:115, 117:125, 127:140)) {
data_test <- readMat(paste("IPEAtests2", M, "/", filenames[i], sep = ""))
start <- data_test$test.data.start[1]
end <- tail(data_test$test.data.end, 1)
yt <- data_test$true.Ytph[h, ] # true value
xt <- data_test$ar.pred[h, ] # linear
xt2 <- data_test$tsboost.pred[h, ] # tsboost
xt3 <- data_test$bspline.pred[h, ] # bspline
xt4 <- data_test$bols.pred[h, ] # bols
xt5 <- data_test$bspline.noextra.pred[h,]
xt6 <- data_test$tsboost.noextra.pred[h,]
xt7 <- data_test$tree2.pred[h,]
var <- data_test$const.pred[h, ] # for var
tl <- start:(end - h)
ind <- gw.test(xt4[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bols"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt3[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline"] <- ifelse(ind <= 0.1, 1, 0)
ind <- gw.test(xt2[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost"] <- ifelse(ind <= 0.1, 1, 0)
ind <- gw.test(xt5[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline2"] <- ifelse(ind <= 0.1, 1, 0)
ind <- gw.test(xt6[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost2"] <- ifelse(ind <= 0.1, 1, 0)
ind <- gw.test(xt7[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'greater', method = 'HAC')$p.value
all_cases[[h]][i, "tree"] <- ifelse(ind <= 0.1, 1, 0)
}
}
all <- data.frame(
"linear" = rep(0, 12),
"bols" = rep(0, 12),
"bspline" = rep(0, 12),
"tsboost" = rep(0, 12),
"bspline2" = rep(0, 12),
"tsboost2" = rep(0, 12),
"tree" = rep(0, 12)
)
for (i in 1:12) {
base = all_cases[[i]]
all[i, ] <- sapply(base, sum)
}
all
for (h in 1:12) {
for (i in c(1:32, 34:44, 47:65, 67:90, 92:107, 109:115, 117:125, 127:140)) {
data_test <- readMat(paste("IPEAtests2", M, "/", filenames[i], sep = ""))
start <- data_test$test.data.start[1]
end <- tail(data_test$test.data.end, 1)
yt <- data_test$true.Ytph[h, ] # true value
xt <- data_test$ar.pred[h, ] # linear
xt2 <- data_test$tsboost.pred[h, ] # tsboost
xt3 <- data_test$bspline.pred[h, ] # bspline
xt4 <- data_test$bols.pred[h, ] # bols
xt5 <- data_test$bspline.noextra.pred[h,]
xt6 <- data_test$tsboost.noextra.pred[h,]
xt7 <- data_test$tree2.pred[h,]
var <- data_test$const.pred[h, ] # for var
tl <- start:(end - h)
ind <- gw.test(xt[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "linear"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt4[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bols"] <- ifelse(ind <= 0.1, 1, 0)
ind <- gw.test(xt3[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline"] <- ifelse(ind <= 0.1, 1, 0)
ind <- gw.test(xt2[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost"] <- ifelse(ind <= 0.1, 1, 0)
ind <- gw.test(xt5[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "bspline2"] <- ifelse(ind <= 0.1, 1, 0)
ind <- gw.test(xt6[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_cases[[h]][i, "tsboost2"] <- ifelse(ind <= 0.1, 1, 0)
ind <- gw.test(xt7[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'greater', method = 'HAC')$p.value
all_cases[[h]][i, "tree"] <- ifelse(ind <= 0.1, 1, 0)
}
}
i
h
M <- 300
filenames <- list.files(paste("IPEAtests2", M, "/", sep = ""))
linear <- rep(0, 140)
bols <- rep(0, 140)
bspline <- rep(0, 140)
tsboost <- rep(0, 140)
bspline2 <- rep(0, 140)
tsboost2 <- rep(0, 140)
tree  <- rep(0, 140)
all_05 <- list()
for (i in 1:12) {
all_cases[[i]] <- data.frame(linear, bols, bspline, tsboost, bspline2, tsboost2, tree)
}
all_10 = all_05
M <- 300
filenames <- list.files(paste("IPEAtests2", M, "/", sep = ""))
linear <- rep(0, 140)
bols <- rep(0, 140)
bspline <- rep(0, 140)
tsboost <- rep(0, 140)
bspline2 <- rep(0, 140)
tsboost2 <- rep(0, 140)
tree  <- rep(0, 140)
all_05 <- list()
for (i in 1:12) {
all_cases[[i]] <- data.frame(linear, bols, bspline, tsboost, bspline2, tsboost2, tree)
}
all_10 = all_05
for (h in 1:12) {
for (i in c(1:32, 34:44, 47:65, 67:90, 92:107, 109:115, 117:125, 127:140)) {
data_test <- readMat(paste("IPEAtests2", M, "/", filenames[i], sep = ""))
start <- data_test$test.data.start[1]
end <- tail(data_test$test.data.end, 1)
yt <- data_test$true.Ytph[h, ] # true value
xt <- data_test$ar.pred[h, ] # linear
xt2 <- data_test$tsboost.pred[h, ] # tsboost
xt3 <- data_test$bspline.pred[h, ] # bspline
xt4 <- data_test$bols.pred[h, ] # bols
xt5 <- data_test$bspline.noextra.pred[h,]
xt6 <- data_test$tsboost.noextra.pred[h,]
xt7 <- data_test$tree2.pred[h,]
var <- data_test$const.pred[h, ] # for var
tl <- start:(end - h)
ind <- gw.test(xt4[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_10[[h]][i, "bols"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "bols"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt3[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_10[[h]][i, "bspline"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "bspline"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt2[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_10[[h]][i, "tsboost"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "tsboost"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt5[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_10[[h]][i, "bspline2"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "bspline2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt6[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_10[[h]][i, "tsboost2"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "tsboost2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt7[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'greater', method = 'HAC')$p.value
all_10[[h]][i, "tree"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "tree"] <- ifelse(ind <= 0.05, 1, 0)
}
}
all <- data.frame(
"linear" = rep(0, 12),
"bols" = rep(0, 12),
"bspline" = rep(0, 12),
"tsboost" = rep(0, 12),
"bspline2" = rep(0, 12),
"tsboost2" = rep(0, 12),
"tree" = rep(0, 12)
)
linear <- rep(0, 140)
bols <- rep(0, 140)
bspline <- rep(0, 140)
tsboost <- rep(0, 140)
bspline2 <- rep(0, 140)
tsboost2 <- rep(0, 140)
tree  <- rep(0, 140)
all_05 <- list()
all_05[[i]] <- data.frame(linear, bols, bspline, tsboost, bspline2, tsboost2, tree)
M <- 300
filenames <- list.files(paste("IPEAtests2", M, "/", sep = ""))
linear <- rep(0, 140)
bols <- rep(0, 140)
bspline <- rep(0, 140)
tsboost <- rep(0, 140)
bspline2 <- rep(0, 140)
tsboost2 <- rep(0, 140)
tree  <- rep(0, 140)
all_05 <- list()
for (i in 1:12) {
all_05[[i]] <- data.frame(linear, bols, bspline, tsboost, bspline2, tsboost2, tree)
}
all_10 = all_05
for (h in 1:12) {
for (i in c(1:32, 34:44, 47:65, 67:90, 92:107, 109:115, 117:125, 127:140)) {
data_test <- readMat(paste("IPEAtests2", M, "/", filenames[i], sep = ""))
start <- data_test$test.data.start[1]
end <- tail(data_test$test.data.end, 1)
yt <- data_test$true.Ytph[h, ] # true value
xt <- data_test$ar.pred[h, ] # linear
xt2 <- data_test$tsboost.pred[h, ] # tsboost
xt3 <- data_test$bspline.pred[h, ] # bspline
xt4 <- data_test$bols.pred[h, ] # bols
xt5 <- data_test$bspline.noextra.pred[h,]
xt6 <- data_test$tsboost.noextra.pred[h,]
xt7 <- data_test$tree2.pred[h,]
var <- data_test$const.pred[h, ] # for var
tl <- start:(end - h)
ind <- gw.test(xt4[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_10[[h]][i, "bols"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "bols"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt3[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_10[[h]][i, "bspline"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "bspline"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt2[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_10[[h]][i, "tsboost"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "tsboost"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt5[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_10[[h]][i, "bspline2"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "bspline2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt6[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'less', method = 'HAC')$p.value
all_10[[h]][i, "tsboost2"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "tsboost2"] <- ifelse(ind <= 0.05, 1, 0)
ind <- gw.test(xt7[tl],xt[tl],yt[tl], tau = h, T=288, alternative = 'greater', method = 'HAC')$p.value
all_10[[h]][i, "tree"] <- ifelse(ind <= 0.1, 1, 0)
all_05[[h]][i, "tree"] <- ifelse(ind <= 0.05, 1, 0)
}
}
all10 <- data.frame(
"linear" = rep(0, 12),
"bols" = rep(0, 12),
"bspline" = rep(0, 12),
"tsboost" = rep(0, 12),
"bspline2" = rep(0, 12),
"tsboost2" = rep(0, 12),
"tree" = rep(0, 12)
)
all05 <- all10
for (i in 1:12) {
base = all_10[[i]]
all10[i, ] <- sapply(base, sum)
base = all_05[[i]]
all05[i, ] <- sapply(base, sum)
}
all05
all10
clipr::write_clip(t(all10))
clipr::write_clip(t(all05))
